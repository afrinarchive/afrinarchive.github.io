<!DOCTYPE html>
<html lang="en" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archive | Zerka</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- START: LEAFLET & PLUGIN CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
    <!-- END: LEAFLET & PLUGIN CSS -->

    <style>
        /* Use the Inter font family */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Light theme variables */
        :root {
            --bg-color: #f0f2e6;
            --text-color: #000000;
            --border-color: #000000;
            --card-bg-color: #f0f2e6;
            --subtext-color: #4a5568;
            --link-color: #2563eb;
            --button-hover-bg: #000000;
            --button-hover-text: #f0f2e6;
            --internal-link-color: #2563eb; /* This is the blue for light mode */
        }
        /* Dark theme variables from user image */
        .dark {
            --bg-color: #2d2d2d;
            --text-color: #f1f1f1;
            --border-color: #555555;
            --card-bg-color: #2d2d2d;
            --subtext-color: #999999;
            --link-color: #63b3ed;
            --button-hover-bg: #f1f1f1;
            --button-hover-text: #2d2d2d;
            --internal-link-color: #86efac; /* This is the light green from your image */
        }
        /* Applying theme colors */
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
        }
        .card {
            background-color: var(--card-bg-color);
            border: 1px solid var(--border-color);
            transition: background-color 0.3s, border-color 0.3s;
        }
        h1, h2, h3, .prose {
            color: var(--text-color);
        }
        .subtext {
             color: var(--subtext-color);
        }
        .themed-border {
            border-color: var(--border-color);
        }
        .internal-link {
            text-decoration: none; /* This removes the underline */
            cursor: pointer;
            color: var(--internal-link-color); /* This uses a new dedicated color variable */
        }
        .external-link {
            color: var(--link-color);
        }
        .button-style {
             border: 1px solid var(--border-color);
        }
        .button-style:hover {
            background-color: var(--button-hover-bg);
            color: var(--button-hover-text);
        }
        /* Details/Summary styles */
        details > summary {
            list-style: none;
        }
        details > summary::-webkit-details-marker {
            display: none;
        }
        .prose strong {
            font-weight: 600;
        }
        .prose p {
            margin-bottom: 1rem;
        }
        .prose ol, .prose ul {
            margin-bottom: 1rem;
        }
        /* Inverted colors for the theme toggle button */
        .toggle-button-colors {
            background-color: var(--text-color);
            color: var(--bg-color);
            border: 1px solid var(--border-color);
        }
        /* Custom styles for Leaflet popups and controls to match theme */
        .leaflet-popup-content-wrapper, .leaflet-control-layers {
            background-color: var(--card-bg-color) !important;
            color: var(--text-color) !important;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        .leaflet-popup-tip {
            background: var(--card-bg-color) !important;
        }
        .leaflet-popup-close-button {
            color: var(--text-color) !important;
        }
        .leaflet-popup-content b {
            font-weight: 600;
        }
        .leaflet-popup-content span {
            color: var(--subtext-color);
            text-transform: capitalize;
        }
        /* FIXED: CSS errors resolved by URL-encoding the SVG data */
        .leaflet-control-layers-toggle {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23000'%3e%3cpath d='M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5'/%3e%3c/svg%3e") !important;
            background-size: 20px 20px !important;
        }
        .dark .leaflet-control-layers-toggle {
             background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23fff'%3e%3cpath d='M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5'/%3e%3c/svg%3e") !important;
        }
        .leaflet-control-scale-line {
            background: var(--card-bg-color);
            border-color: var(--text-color);
            color: var(--text-color);
        }

        /* Lightbox Styles */
        .lightbox-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            cursor: pointer;
        }
        .lightbox-image {
            max-width: 90vw;
            max-height: 90vh;
            border: 3px solid var(--border-color);
            border-radius: 8px;
        }
        .lightbox-close {
            position: absolute;
            top: 20px;
            right: 30px;
            font-size: 3rem;
            color: white;
            cursor: pointer;
            line-height: 1;
        }
    </style>
</head>
<body>

    <div class="container mx-auto p-4 sm:p-6 md:p-8 max-w-4xl">
        <!-- Header Section -->
        <header class="mb-8">
            <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold">Zerka</h1>
        </header>

        <main class="space-y-6">
            <!-- Basic Information Card -->
            <div class="card p-6 rounded-xl">
                <div class="flex justify-between items-center border-b themed-border pb-3 mb-4">
                    <h2 class="text-2xl font-semibold">General Information</h2>
                    <!-- Dark Mode Toggle -->
                    <button id="theme-toggle" class="toggle-button-colors p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2" style="--ring-offset-color: var(--card-bg-color); --ring-color: var(--border-color);">
                        <svg id="theme-toggle-dark-icon" class="hidden h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                        <svg id="theme-toggle-light-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="hidden h-6 w-6">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
                        </svg>
                    </button>
                </div>
                <div class="grid grid-cols-1 gap-4">
                    <div>
                        <h3 class="text-sm font-medium subtext">Nahiya (Subdistrict)</h3>
                        <p class="text-lg">Rajo</p>
                    </div>
                    <div>
                        <h3 class="text-sm font-medium subtext">Alternative Spellings</h3>
                        <p class="text-lg">Zerka</p>
                    </div>
                </div>
            </div>

            <!-- Map and Location Card -->
            <div class="card p-6 rounded-xl">
                <h2 class="text-2xl font-semibold border-b themed-border pb-3 mb-4">Map and Location</h2>
                <div id="map" class="rounded-lg border themed-border" style="height: 450px;"></div>
                <div class="mt-4 flex flex-col sm:flex-row flex-wrap justify-between items-center gap-4">
                    <p class="text-sm">Coordinates: 36.704396, 36.741702</p>
                </div>
                 <p class="text-xs subtext mt-3">Source: <a href="https://akmckeever.substack.com/" class="hover:underline external-link">akmckeever.substack.com</a></p>
            </div>
            
            <!-- Photos Card -->
            <div class="card p-6 rounded-xl">
                <h2 class="text-2xl font-semibold border-b themed-border pb-3 mb-4">Photos</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><img src="../village_photos/Zerka.jpg" alt="Photo of Zerka" class="lightbox-trigger rounded-lg w-full h-auto object-cover border themed-border cursor-pointer" onerror="this.onerror=null;this.src='https://placehold.co/600x400/e2e8f0/4a5568?text=Zerka.jpg';"><img src="../village_photos/zarka.jpg" alt="Photo of zarka" class="lightbox-trigger rounded-lg w-full h-auto object-cover border themed-border cursor-pointer" onerror="this.onerror=null;this.src='https://placehold.co/600x400/e2e8f0/4a5568?text=zarka.jpg';"></div>
            </div>

            <!-- Summaries Card (I-IV) -->
            <div class="card p-6 rounded-xl">
                <h2 class="text-2xl font-semibold border-b themed-border pb-3 mb-4">Summaries</h2>
                <div class="space-y-4"><details class="group" open><summary class="flex justify-between items-center font-semibold p-3 cursor-pointer text-lg"><span>I. Summary from TirejAfrin Site</span><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 transform transition-transform group-open:rotate-180 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg></summary><div class="p-4 prose max-w-none"><p style="margin-bottom: 1em;"># Zerka (زركانلي)</p>
<p style="margin-bottom: 1em;">According to the book '<span class="internal-link">جبل الكرد</span>' '<span class="internal-link">Mountain of the Kurds</span>' (<span class="internal-link">Afrin</span>) Geographic Study by <span class="internal-link">Dr. Mohammed Abdo Ali</span> (الدكتور محمد عبدو علي):</p>
<p style="margin-bottom: 1em;"><strong><span class="internal-link">Zerka</span> (زركانلي) (الطلة – المطلة)</strong> /792n - 131h - 15km - 740m/:</p>
<ul>
<li><span class="internal-link">Zerka</span> (زَرْكا): Name of a Kurdish tribe found around <span class="internal-link">Bidlis</span> (بدليس) /Lerkh, p.49/. They had an emirate called "<span class="internal-link">Zaraki – Zariki- Zarqi</span>" (زراكي – زريكي- زرقي) in <span class="internal-link">Mardin</span> (ماردين). This emirate was founded by <span class="internal-link">Sheikh Hasan</span> (الشيخ حسن) who came from <span class="internal-link">Syria</span> (سوريا), and four ruling families emerged from his lineage, one of which was called <span class="internal-link">Darzini</span> (درزيني) which is said to be connected to the <span class="internal-link">Druze</span> (الدرزية) religion and its founder <span class="internal-link">Ismail Al-Darzi</span> (إسماعيل الدرزي), and that he was from the emirate's offspring, and those families ruled during the <span class="internal-link">Ottoman</span> (العثمانيين) era /A.Zaki, J 2, p.375/.</li>
<li>A small village located on the eastern slope of <span class="internal-link">Bilal</span> (بلال) mountain.</li>
</ul>
<p style="margin-bottom: 1em;">Also according to the book: '<span class="internal-link">عفرين نهرها ورواييها الخضراء</span>' '<span class="internal-link">Afrin... Its Rivers and Green Hills</span>' by writer <span class="internal-link">Abdulrahman Mohammed</span> (عبدالرحمن محمد) from <span class="internal-link">Qatma</span> (قطمه) village:</p>
<p style="margin-bottom: 1em;"><strong><span class="internal-link">Zarkanli</span> (زركانلي)</strong>: A village in <span class="internal-link">Kurdish Mountain</span> (جبل الكرد) belonging to <span class="internal-link">Rajo</span> (راجو) subdistrict, <span class="internal-link">Afrin</span> (عفرين) region, <span class="internal-link">Aleppo</span> (حلب) governorate.</p>
<p style="margin-bottom: 1em;">It is a small village located in the central part of the aforementioned mountain, on the eastern slope of the calcareous heights. It is 15 km northeast of <span class="internal-link">Rajo</span> (راجو) town, overlooking east and south onto agricultural lands descending southeast and oak forests spread over the mountain slopes, with alluvial soil. To the north lies a very high rough mountain chain and <span class="internal-link">Alamdar</span> (علمدار) village and <span class="internal-link">Korzil</span> (كورزيل) village. To the south lies a slope and plain and <span class="internal-link">Jital Qowiyu</span> (جتال قويو) village. To the east lies a mountain chain and stream and <span class="internal-link">Kilanli</span> (كيلانلي) village. To the west lies a mountain chain and <span class="internal-link">Jobanli</span> (جوبانلي) village. The number of houses is approximately 40, and its age is approximately 300 years according to the account of one of the elderly residents in the village. Its old dwellings are stone-clay with wooden roofs and modern concrete ones extend to its outskirts. It has electricity and a prefabricated elementary school and unpaved dirt road. The residents work in rain-fed agriculture (olives, grains, legumes, grapes) on an area of 131 hectares and raise sheep and goats. Some residents work in wood charcoal production from oak trees. The village drinks from rainwater collected in cisterns dug in front of houses and currently by digging artesian wells within the house courtyards. There is an old archaeological water well from the <span class="internal-link">Roman</span> (الرومان) era on the western side of the village. Among the social figures is engineer <span class="internal-link">Kamal</span> (كمال) (<span class="internal-link">Abu Mirfan</span> (أبو ميرفان)).</p>
<p style="margin-bottom: 1em;">Village mayor: <span class="internal-link">Mr. Abdo Ahmed Mohammed</span> (السيد عبدو أحمد محمد)</p>
<p style="margin-bottom: 1em;">Prepared and executed by: <span class="internal-link">Tirij Afrin</span> (تيريج عفرين) website director: <span class="internal-link">Abdulrahman Haji Othman</span> (عبدالرحمن حاجي عثمان)</p>
<p style="margin-bottom: 1em;"><span class="internal-link">20</span>/12/<span class="internal-link">2013</span></p></div></details><hr class="themed-border"><details class="group" open><summary class="flex justify-between items-center font-semibold p-3 cursor-pointer text-lg"><span>II. Summary from Ax û Walat Transcript</span><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 transform transition-transform group-open:rotate-180 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg></summary><div class="p-4 prose max-w-none"><p style="margin-bottom: 1em;">The village of <span class="internal-link">Zarka</span> was established approximately 200-300 years ago (02:33), though some sources say it could be as old as 400 years (05:56). The first family to settle was that of <span class="internal-link">Mihemedî Zîzê</span>, followed by the families of <span class="internal-link">Tewdî</span>, <span class="internal-link">Şêxê Xalozê</span>, and <span class="internal-link">Mihê</span> (02:39-02:52). Before a time referred to as <span class="internal-link">Azmîçêbê</span>, only two or three families lived there (03:01). The history of <span class="internal-link">Afrînê</span>'s villages is not well-documented due to suppression by ruling regimes (06:15). Some believe the villagers originally came from a place called <span class="internal-link">Xanê Bedran</span> (06:59). The village school was opened in <span class="internal-link">1952</span>; before that, itinerant teachers provided lessons (04:25). Historically, residents traveled by camel to <span class="internal-link">Kilis</span>, <span class="internal-link">Afrîn</span>, <span class="internal-link">E'zaz</span>, and <span class="internal-link">Heleb</span> for trade (05:10). The nearby <span class="internal-link">Mount Bilalê Hebeş</span> contains a cave with ancient cisterns and ruins, suggesting a settlement over 2,000 years old (11:05). In the <span class="internal-link">1980s</span>, villagers performed sacrifices on the mountain (09:36), a continuation of the site's use as a pilgrimage location to pray for rain (12:16). Before <span class="internal-link">1974</span>, there were no modern roads to the area; villagers collectively built their own road after one was constructed in <span class="internal-link">Çaxmaqê Çûçek</span> (25:05-25:21). For generations, <span class="internal-link">Zarka</span> and four other villages relied on a very old well in <span class="internal-link">Çobana</span>, estimated to be at least 200 years old (30:51, 32:03). Water was drawn using a traditional animal-powered wheel system (33:51). Electricity did not arrive in the village until approximately <span class="internal-link">2002</span> (21:48).</p></div></details><hr class="themed-border"></div>

            <!-- Links Card (V) -->
            <div class="card p-6 rounded-xl">
                <h2 class="text-2xl font-semibold border-b themed-border pb-3 mb-4">V. Links</h2>
                <ul class="list-disc list-inside space-y-2 p-4"><li>Tirejafrin<br><a href="http://www.tirejafrin.com/site/kura%20afrin%20%20%20Reco%20-%20zerka.htm" target="_blank" rel="noopener noreferrer" class="external-link hover:underline break-all">http://www.tirejafrin.com/site/kura%20afrin%20%20%20Reco%20-%20zerka.htm</a><br><a href="https://www.welateme.net/erebi/modules.php?name=News&file=print&sid=22507" target="_blank" rel="noopener noreferrer" class="external-link hover:underline break-all">https://www.welateme.net/erebi/modules.php?name=News&file=print&sid=22507</a></li><li>Ax û Welat<br><a href="https://www.youtube.com/watch?v=B6N9quZ26S4" target="_blank" rel="noopener noreferrer" class="external-link hover:underline break-all">https://www.youtube.com/watch?v=B6N9quZ26S4</a><br><a href="https://www.youtube.com/watch?v=4pBA9djRct4" target="_blank" rel="noopener noreferrer" class="external-link hover:underline break-all">https://www.youtube.com/watch?v=4pBA9djRct4</a></li></ul>
            </div>

            <!-- Additional Information Card (VI-X) -->
            

            <!-- Additional Summaries and Transcripts Card (XI-XVII) -->
            

        </main>

        <!-- Footer -->
        <footer class="text-center mt-12 py-4 border-t themed-border">
            <p class="text-sm subtext">Generated for archive purposes.</p>
        </footer>
    </div>

    <!-- START: LIGHTBOX HTML -->
    <div id="lightbox" class="lightbox-overlay hidden">
        <span id="lightbox-close" class="lightbox-close">&times;</span>
        <img id="lightbox-image" class="lightbox-image" src="">
    </div>
    <!-- END: LIGHTBOX HTML -->

    <!-- START: LEAFLET & PLUGIN JAVASCRIPT -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <!-- END: LEAFLET & PLUGIN JAVASCRIPT -->

    <script>
        // Theme toggle script (unchanged)
        const themeToggleBtn = document.getElementById('theme-toggle');
        const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
        const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');
        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            themeToggleLightIcon.classList.remove('hidden');
        } else {
            document.documentElement.classList.remove('dark');
            themeToggleDarkIcon.classList.remove('hidden');
        }
        themeToggleBtn.addEventListener('click', function() {
            themeToggleDarkIcon.classList.toggle('hidden');
            themeToggleLightIcon.classList.toggle('hidden');
            if (localStorage.getItem('color-theme')) {
                if (localStorage.getItem('color-theme') === 'light') {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                } else {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                }
            } else {
                if (document.documentElement.classList.contains('dark')) {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                } else {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                }
            }
        });

        // Main script runs after the page content has loaded
        document.addEventListener('DOMContentLoaded', function () {
            
            // --- LIGHTBOX SCRIPT ---
            const lightbox = document.getElementById('lightbox');
            const lightboxImage = document.getElementById('lightbox-image');
            const lightboxClose = document.getElementById('lightbox-close');
            const imageTriggers = document.querySelectorAll('.lightbox-trigger');

            imageTriggers.forEach(trigger => {
                trigger.addEventListener('click', () => {
                    lightboxImage.src = trigger.src;
                    lightbox.classList.remove('hidden');
                });
            });

            function closeLightbox() {
                lightbox.classList.add('hidden');
            }

            lightbox.addEventListener('click', closeLightbox);
            lightboxClose.addEventListener('click', closeLightbox);
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeLightbox();
                }
            });

            // --- MAP SCRIPT ---
            const iconConfig = {
                shrine: { pinColor: '#28a745', iconColor: '#ffffff', svg: '<path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>' },
                landmark: { pinColor: '#ffc107', iconColor: '#ffffff', svg: '<path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>' },
                transport: { pinColor: '#007bff', iconColor: '#ffffff', svg: '<path d="M12 2c-4 0-8 3.5-8 8v6c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-6c0-4.5-4-8-8-8zm0 2c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm-6 8h12v4H6v-4z"/>' },
                settlement: { pinColor: '#343a40', iconColor: '#ffffff', svg: '<path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>' },
                historical_site: { pinColor: '#6f42c1', iconColor: '#ffffff', svg: '<path d="M12 2L2 7v2h20V7L12 2zM4 10v10h2V10H4zm5 0v10h2V10H9zm5 0v10h2V10h-2zm5 0v10h2V10h-2z"/>' },
                infrastructure: { pinColor: '#6c757d', iconColor: '#ffffff', svg: '<path d="M20.5 16.5c.83 0 1.5-.67 1.5-1.5s-.67-1.5-1.5-1.5-1.5.67-1.5 1.5.67 1.5 1.5 1.5zm-17 0c.83 0 1.5-.67 1.5-1.5S4.33 13.5 3.5 13.5 2 14.17 2 15s.67 1.5 1.5 1.5zm17-13C21.33 3.5 22 4.17 22 5s-.67 1.5-1.5 1.5S19 5.83 19 5s.67-1.5 1.5-1.5zM3.5 5c.83 0 1.5-.67 1.5-1.5S4.33 2 3.5 2 2 2.67 2 3.5 2.67 5 3.5 5zm9.45 2.55L5.71 11.29c-.39.39-.39 1.02 0 1.41l8.49 8.49c.39.39 1.02.39 1.41 0l7.24-7.24c.39-.39.39-1.02 0-1.41L14.37 5.29c-.39-.39-1.03-.39-1.42 0z"/>' },
                military: { pinColor: '#dc3545', iconColor: '#ffffff', svg: '<path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>' },
                default: { pinColor: '#343a40', iconColor: '#ffffff', svg: '<path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>' }
            };

            function createCustomIcon(type, isMain) {
                const config = iconConfig[type] || iconConfig.default;
                const iconSize = isMain ? [36, 36] : [30, 30];
                const iconAnchor = isMain ? [18, 36] : [15, 30];
                const popupAnchor = [0, -iconSize[1] + 4];
                const iconInnerSize = isMain ? 20 : 16;
                const topPadding = (iconSize[1] - iconInnerSize) / 2 - (isMain ? 2 : 2);

                const html = `
                    <div style="position: relative; width: ${iconSize[0]}px; height: ${iconSize[1]}px; display: flex; justify-content: center; align-items: flex-start; padding-top: ${topPadding}px;">
                        <svg viewBox="0 0 24 24" width="${iconSize[0]}" height="${iconSize[1]}" style="position: absolute; left: 0; top: 0; filter: drop-shadow(0 2px 2px rgba(0,0,0,0.5));">
                            <path fill="${config.pinColor}" d="M12,2C8.1,2,5,5.1,5,9c0,5.2,7,13,7,13s7-7.8,7-13C19,5.1,15.9,2,12,2z"></path>
                        </svg>
                        <svg viewBox="0 0 24 24" width="${iconInnerSize}" height="${iconInnerSize}" style="position: relative; fill: ${config.iconColor};">
                            ${config.svg}
                        </svg>
                    </div>`;

                return L.divIcon({
                    html: html,
                    className: '',
                    iconSize: iconSize,
                    iconAnchor: iconAnchor,
                    popupAnchor: popupAnchor
                });
            }

            const mainVillageName = "Zerka";
            const villageLat = 36.704396;
            const villageLng = 36.741702;
            const initialZoom = 14;

            const map = L.map('map').setView([villageLat, villageLng], initialZoom);

            // --- Define all the map layers ---
            const esriImagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                attribution: 'Tiles &copy; Esri'
            });

            const osmStreet = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            });

            const thunderforestTerrain = L.tileLayer('https://{s}.tile.thunderforest.com/outdoors/{z}/{x}/{y}{r}.png?apikey={apikey}', {
                attribution: '&copy; <a href="http://www.thunderforest.com/">Thunderforest</a>, &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
                apikey: 'e030b1cd0c1041a69a5ca2b0ca2ebe36', 
                maxZoom: 22
            });

            // --- Set up the layer control ---
            const baseMaps = {
                "Satellite": esriImagery,
                "Street": osmStreet,
                "Terrain": thunderforestTerrain
            };
            
            L.control.layers(baseMaps).addTo(map);
            esriImagery.addTo(map);

            // --- ADD MAP CONTROLS ---
            // 1. Static Scale Bar
            L.control.scale({ imperial: false }).addTo(map);

            // --- Fetch data and add markers ---
            fetch('afrin_locations.json')
                .then(response => {
                    if (!response.ok) throw new Error('Network response was not ok');
                    return response.json();
                })
                .then(locations => {
                    locations.forEach(location => {
                        const isMainVillage = location.name === mainVillageName;
                        const customIcon = createCustomIcon(location.type, isMainVillage);
                        
                        const marker = L.marker([location.lat, location.lng], { 
                            icon: customIcon,
                            zIndexOffset: isMainVillage ? 1000 : 0
                        }).addTo(map);
                        
                        marker.bindPopup(`<b>${location.name}</b><br><span>${location.type.replace(/_/g, ' ')}</span>`);

                        if (isMainVillage) {
                            marker.openPopup();
                        }
                    });
                })
                .catch(error => {
                    console.error('Error loading location data:', error);
                    const mapDiv = document.getElementById('map');
                    mapDiv.innerHTML = '<div style="text-align:center; padding: 20px; color: var(--subtext-color);">Could not load map data.<br>Please ensure <strong>afrin_locations.json</strong> is in the same folder as this HTML file.</div>';
                });
        });
    </script>
</body>
</html>
