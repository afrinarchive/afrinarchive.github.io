<!DOCTYPE html>
<html lang="en" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archive | Umera</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- START: LEAFLET & PLUGIN CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
    <!-- END: LEAFLET & PLUGIN CSS -->

    <style>
        /* Use the Inter font family */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Light theme variables */
        :root {
            --bg-color: #f0f2e6;
            --text-color: #000000;
            --border-color: #000000;
            --card-bg-color: #f0f2e6;
            --subtext-color: #4a5568;
            --link-color: #2563eb;
            --button-hover-bg: #000000;
            --button-hover-text: #f0f2e6;
            --internal-link-color: #2563eb; /* This is the blue for light mode */
        }
        /* Dark theme variables from user image */
        .dark {
            --bg-color: #2d2d2d;
            --text-color: #f1f1f1;
            --border-color: #555555;
            --card-bg-color: #2d2d2d;
            --subtext-color: #999999;
            --link-color: #63b3ed;
            --button-hover-bg: #f1f1f1;
            --button-hover-text: #2d2d2d;
            --internal-link-color: #86efac; /* This is the light green from your image */
        }
        /* Applying theme colors */
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
        }
        .card {
            background-color: var(--card-bg-color);
            border: 1px solid var(--border-color);
            transition: background-color 0.3s, border-color 0.3s;
        }
        h1, h2, h3, .prose {
            color: var(--text-color);
        }
        .subtext {
             color: var(--subtext-color);
        }
        .themed-border {
            border-color: var(--border-color);
        }
        .internal-link {
            text-decoration: none; /* This removes the underline */
            cursor: pointer;
            color: var(--internal-link-color); /* This uses a new dedicated color variable */
        }
        .external-link {
            color: var(--link-color);
        }
        .button-style {
             border: 1px solid var(--border-color);
        }
        .button-style:hover {
            background-color: var(--button-hover-bg);
            color: var(--button-hover-text);
        }
        /* Details/Summary styles */
        details > summary {
            list-style: none;
        }
        details > summary::-webkit-details-marker {
            display: none;
        }
        .prose strong {
            font-weight: 600;
        }
        .prose p {
            margin-bottom: 1rem;
        }
        .prose ol, .prose ul {
            margin-bottom: 1rem;
        }
        /* Inverted colors for the theme toggle button */
        .toggle-button-colors {
            background-color: var(--text-color);
            color: var(--bg-color);
            border: 1px solid var(--border-color);
        }
        /* Custom styles for Leaflet popups and controls to match theme */
        .leaflet-popup-content-wrapper, .leaflet-control-layers {
            background-color: var(--card-bg-color) !important;
            color: var(--text-color) !important;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        .leaflet-popup-tip {
            background: var(--card-bg-color) !important;
        }
        .leaflet-popup-close-button {
            color: var(--text-color) !important;
        }
        .leaflet-popup-content b {
            font-weight: 600;
        }
        .leaflet-popup-content span {
            color: var(--subtext-color);
            text-transform: capitalize;
        }
        /* FIXED: CSS errors resolved by URL-encoding the SVG data */
        .leaflet-control-layers-toggle {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23000'%3e%3cpath d='M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5'/%3e%3c/svg%3e") !important;
            background-size: 20px 20px !important;
        }
        .dark .leaflet-control-layers-toggle {
             background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23fff'%3e%3cpath d='M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5'/%3e%3c/svg%3e") !important;
        }
        .leaflet-control-scale-line {
            background: var(--card-bg-color);
            border-color: var(--text-color);
            color: var(--text-color);
        }

        /* Lightbox Styles */
        .lightbox-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            cursor: pointer;
        }
        .lightbox-image {
            max-width: 90vw;
            max-height: 90vh;
            border: 3px solid var(--border-color);
            border-radius: 8px;
        }
        .lightbox-close {
            position: absolute;
            top: 20px;
            right: 30px;
            font-size: 3rem;
            color: white;
            cursor: pointer;
            line-height: 1;
        }
    </style>
</head>
<body>

    <div class="container mx-auto p-4 sm:p-6 md:p-8 max-w-4xl">
        <!-- Header Section -->
        <header class="mb-8">
            <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold">Umera</h1>
        </header>

        <main class="space-y-6">
            <!-- Basic Information Card -->
            <div class="card p-6 rounded-xl">
                <div class="flex justify-between items-center border-b themed-border pb-3 mb-4">
                    <h2 class="text-2xl font-semibold">General Information</h2>
                    <!-- Dark Mode Toggle -->
                    <button id="theme-toggle" class="toggle-button-colors p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2" style="--ring-offset-color: var(--card-bg-color); --ring-color: var(--border-color);">
                        <svg id="theme-toggle-dark-icon" class="hidden h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                        <svg id="theme-toggle-light-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="hidden h-6 w-6">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
                        </svg>
                    </button>
                </div>
                <div class="grid grid-cols-1 gap-4">
                    <div>
                        <h3 class="text-sm font-medium subtext">Nahiya (Subdistrict)</h3>
                        <p class="text-lg">Rajo</p>
                    </div>
                    <div>
                        <h3 class="text-sm font-medium subtext">Alternative Spellings</h3>
                        <p class="text-lg">Omar, Omar Oshaghi, Ûmera, عمر, عمر اوشاغي</p>
                    </div>
                </div>
            </div>

            <!-- Map and Location Card -->
            <div class="card p-6 rounded-xl">
                <h2 class="text-2xl font-semibold border-b themed-border pb-3 mb-4">Map and Location</h2>
                <div id="map" class="rounded-lg border themed-border" style="height: 450px;"></div>
                <div class="mt-4 flex flex-col sm:flex-row flex-wrap justify-between items-center gap-4">
                    <p class="text-sm">Coordinates: 36.604836, 36.625117</p>
                </div>
                 <p class="text-xs subtext mt-3">Source: <a href="https://akmckeever.substack.com/" class="hover:underline external-link">akmckeever.substack.com</a></p>
            </div>
            
            <!-- Photos Card -->
            <div class="card p-6 rounded-xl">
                <h2 class="text-2xl font-semibold border-b themed-border pb-3 mb-4">Photos</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><img src="../village_photos/Omar Ushaxi.jpg" alt="Photo of Omar Ushaxi" class="lightbox-trigger rounded-lg w-full h-auto object-cover border themed-border cursor-pointer" onerror="this.onerror=null;this.src='https://placehold.co/600x400/e2e8f0/4a5568?text=Omar+Ushaxi.jpg';"><img src="../village_photos/omar ushxe.jpg" alt="Photo of omar ushxe" class="lightbox-trigger rounded-lg w-full h-auto object-cover border themed-border cursor-pointer" onerror="this.onerror=null;this.src='https://placehold.co/600x400/e2e8f0/4a5568?text=omar+ushxe.jpg';"></div>
            </div>

            <!-- Summaries Card (I-IV) -->
            <div class="card p-6 rounded-xl">
                <h2 class="text-2xl font-semibold border-b themed-border pb-3 mb-4">Summaries</h2>
                <div class="space-y-4"><details class="group" open><summary class="flex justify-between items-center font-semibold p-3 cursor-pointer text-lg"><span>I. Summary from TirejAfrin Site</span><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 transform transition-transform group-open:rotate-180 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg></summary><div class="p-4 prose max-w-none"><p style="margin-bottom: 1em;"># Umera (عمر اوشاغي)</p>
<p style="margin-bottom: 1em;"><strong>Villages of <span class="internal-link">Rajo</span> (راجو) District / Reco</strong></p>
<p style="margin-bottom: 1em;"><strong><span class="internal-link">Omar Oshaghi</span> (عمر اوشاغي) - Umera</strong></p></div></details><hr class="themed-border"><details class="group" open><summary class="flex justify-between items-center font-semibold p-3 cursor-pointer text-lg"><span>II. Summary from Ax û Walat Transcript</span><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 transform transition-transform group-open:rotate-180 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg></summary><div class="p-4 prose max-w-none"><p style="margin-bottom: 1em;">Summary to process: The village of Ûmera derives its name from <span class="internal-link">Ûmer</span>, an ancestor from the Milî tribe who lived in ancient times (02:03-02:06). The village and the surrounding Şera district are also associated with the Şikakî tribe, indicating a layered tribal history where the area was once Milî and later Şikak (02:09-02:14, 09:04-09:05). The village has a mixed population of Kurds and Arabs. Arab families, including those from the Bû Sultan and Ne'îmî tribes, reportedly arrived around 300 years ago, with roots in the area since ancient times (02:18-02:31). Several Kurdish families in the village also trace their lineage back to ancient times as a single extended family (02:32-02:36). Relatives of Ûmera's founding families are also found in <span class="internal-link">Dêr Siwanê</span>, <span class="internal-link">Diraqliya</span>, and <span class="internal-link">Şîltentê</span>; other families settled after <span class="internal-link">Ûmer</span>'s arrival (09:06-09:08). Historically, the village relied on a local spring, <span class="internal-link">Gelê Sîmonê</span>, for water before modern wells (03:11-03:13). Agricultural practices included women harvesting crops and using animal-powered threshing boards ("cercere") (30:44-30:52). Women washed clothes at the <span class="internal-link">Kanîya Sîmonê</span> (30:57-31:01) and were skilled in tailoring, weaving, and spinning wool (31:15-31:23). The past is recalled as a time of hardship but also social cohesion, with community help in tasks like making "dims" (grape molasses) at presses, sometimes involving travel to places like <span class="internal-link">Rondan</span> or <span class="internal-link">Lînon</span> (21:31-21:42). Old olive presses were made of wood, with methods possibly learned from <span class="internal-link">Londan</span> or resembling the "work of <span class="internal-link">Elender</span>"; the current press in Ûmera is 50 years old (20:17-20:23, 20:40-20:41, 22:12-22:13). The village contains nearly 300 caves used for storage (27:59). The region around Ûmera is rich in historical sites, including ruins (<span class="internal-link">Xirabê Fîto</span>, <span class="internal-link">Xirabê Çartaqa</span>, <span class="internal-link">Xirab Lêsê</span>), ancient villages (<span class="internal-link">Kûlê Gellek Şikeftene</span>, <span class="internal-link">Qetlebiyê</span>), and shrines like <span class="internal-link">Ziyaretgeha Çamcî Zêrat</span> (18:15-18:22). A local shepherd recounts his ancestors being nomadic shepherds ("goçer") (11:16-11:22) and his own more recent displacement from <span class="internal-link">Heleb</span> (Aleppo) to Efrîn and then the village (11:24-11:29). He notes that shepherding has declined compared to the past (11:42-11:44). The village has a history of patriotic and revolutionary participation, with five martyrs commemorated: <span class="internal-link">Bahoz</span>, <span class="internal-link">Hogir</span>, <span class="internal-link">Minzûr</span>, <span class="internal-link">Reşo</span>, and <span class="internal-link">Dunya</span> (02:51-02:58, 03:00, 35:09-35:11). The villagers defended themselves during an attack by militias ("Çeteyan"), liberating the village (35:12-35:13). The cultural history includes a strong tradition of Dengbêjî (bardic singing) and tambur playing. Musician <span class="internal-link">Mihemedê Hec Welo</span> has played for 65 years, taught by his father <span class="internal-link">Hec Welo</span> (36:43-37:02). He recalls other tambur players from his father's era in Şera (<span class="internal-link">Xezetê Meyrê</span>, <span class="internal-link">Nanê Cafûr</span>) and Mabatê (<span class="internal-link">Xireştê Mela Dîbo</span>) (37:18-37:33). He laments the loss of unrecorded old melodies and epics like "<span class="internal-link">Kilkê Silêmanê</span>" and "<span class="internal-link">Gora Sê Merzel</span>", noting that Kurdish history was preserved by Dengbêjs (37:45, 39:00-39:19). He received awards in <span class="internal-link">2000</span> and at events in <span class="internal-link">Muslimiyê</span> and <span class="internal-link">Cindêrisê</span>, one symbolically named "Ornîn," linking to ancient figures from Nînwa (Nineveh) like <span class="internal-link">Eştar</span> (38:05-38:19, 38:46-38:52).</p></div></details><hr class="themed-border"></div>

            <!-- Links Card (V) -->
            <div class="card p-6 rounded-xl">
                <h2 class="text-2xl font-semibold border-b themed-border pb-3 mb-4">V. Links</h2>
                <ul class="list-disc list-inside space-y-2 p-4"><li>Tirejafrin<br><a href="http://www.tirejafrin.com/site/kura%20afrin%20%20%20Reco%20-%20umera.htm" target="_blank" rel="noopener noreferrer" class="external-link hover:underline break-all">http://www.tirejafrin.com/site/kura%20afrin%20%20%20Reco%20-%20umera.htm</a></li><li>Jawlat<br><a href="https://www.youtube.com/watch?v=nOs42xeciWI" target="_blank" rel="noopener noreferrer" class="external-link hover:underline break-all">https://www.youtube.com/watch?v=nOs42xeciWI</a><br><a href="https://www.youtube.com/watch?v=IgrN_2QjZbE" target="_blank" rel="noopener noreferrer" class="external-link hover:underline break-all">https://www.youtube.com/watch?v=IgrN_2QjZbE</a></li></ul>
            </div>

            <!-- Additional Information Card (VI-X) -->
            

            <!-- Additional Summaries and Transcripts Card (XI-XVII) -->
            

        </main>

        <!-- Footer -->
        <footer class="text-center mt-12 py-4 border-t themed-border">
            <p class="text-sm subtext">Generated for archive purposes.</p>
        </footer>
    </div>

    <!-- START: LIGHTBOX HTML -->
    <div id="lightbox" class="lightbox-overlay hidden">
        <span id="lightbox-close" class="lightbox-close">&times;</span>
        <img id="lightbox-image" class="lightbox-image" src="">
    </div>
    <!-- END: LIGHTBOX HTML -->

    <!-- START: LEAFLET & PLUGIN JAVASCRIPT -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <!-- END: LEAFLET & PLUGIN JAVASCRIPT -->

    <script>
        // Theme toggle script (unchanged)
        const themeToggleBtn = document.getElementById('theme-toggle');
        const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
        const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');
        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            themeToggleLightIcon.classList.remove('hidden');
        } else {
            document.documentElement.classList.remove('dark');
            themeToggleDarkIcon.classList.remove('hidden');
        }
        themeToggleBtn.addEventListener('click', function() {
            themeToggleDarkIcon.classList.toggle('hidden');
            themeToggleLightIcon.classList.toggle('hidden');
            if (localStorage.getItem('color-theme')) {
                if (localStorage.getItem('color-theme') === 'light') {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                } else {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                }
            } else {
                if (document.documentElement.classList.contains('dark')) {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                } else {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                }
            }
        });

        // Main script runs after the page content has loaded
        document.addEventListener('DOMContentLoaded', function () {
            
            // --- LIGHTBOX SCRIPT ---
            const lightbox = document.getElementById('lightbox');
            const lightboxImage = document.getElementById('lightbox-image');
            const lightboxClose = document.getElementById('lightbox-close');
            const imageTriggers = document.querySelectorAll('.lightbox-trigger');

            imageTriggers.forEach(trigger => {
                trigger.addEventListener('click', () => {
                    lightboxImage.src = trigger.src;
                    lightbox.classList.remove('hidden');
                });
            });

            function closeLightbox() {
                lightbox.classList.add('hidden');
            }

            lightbox.addEventListener('click', closeLightbox);
            lightboxClose.addEventListener('click', closeLightbox);
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeLightbox();
                }
            });

            // --- MAP SCRIPT ---
            const iconConfig = {
                shrine: { pinColor: '#28a745', iconColor: '#ffffff', svg: '<path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>' },
                landmark: { pinColor: '#ffc107', iconColor: '#ffffff', svg: '<path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>' },
                transport: { pinColor: '#007bff', iconColor: '#ffffff', svg: '<path d="M12 2c-4 0-8 3.5-8 8v6c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-6c0-4.5-4-8-8-8zm0 2c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm-6 8h12v4H6v-4z"/>' },
                settlement: { pinColor: '#343a40', iconColor: '#ffffff', svg: '<path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>' },
                historical_site: { pinColor: '#6f42c1', iconColor: '#ffffff', svg: '<path d="M12 2L2 7v2h20V7L12 2zM4 10v10h2V10H4zm5 0v10h2V10H9zm5 0v10h2V10h-2zm5 0v10h2V10h-2z"/>' },
                infrastructure: { pinColor: '#6c757d', iconColor: '#ffffff', svg: '<path d="M20.5 16.5c.83 0 1.5-.67 1.5-1.5s-.67-1.5-1.5-1.5-1.5.67-1.5 1.5.67 1.5 1.5 1.5zm-17 0c.83 0 1.5-.67 1.5-1.5S4.33 13.5 3.5 13.5 2 14.17 2 15s.67 1.5 1.5 1.5zm17-13C21.33 3.5 22 4.17 22 5s-.67 1.5-1.5 1.5S19 5.83 19 5s.67-1.5 1.5-1.5zM3.5 5c.83 0 1.5-.67 1.5-1.5S4.33 2 3.5 2 2 2.67 2 3.5 2.67 5 3.5 5zm9.45 2.55L5.71 11.29c-.39.39-.39 1.02 0 1.41l8.49 8.49c.39.39 1.02.39 1.41 0l7.24-7.24c.39-.39.39-1.02 0-1.41L14.37 5.29c-.39-.39-1.03-.39-1.42 0z"/>' },
                military: { pinColor: '#dc3545', iconColor: '#ffffff', svg: '<path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>' },
                default: { pinColor: '#343a40', iconColor: '#ffffff', svg: '<path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>' }
            };

            function createCustomIcon(type, isMain) {
                const config = iconConfig[type] || iconConfig.default;
                const iconSize = isMain ? [36, 36] : [30, 30];
                const iconAnchor = isMain ? [18, 36] : [15, 30];
                const popupAnchor = [0, -iconSize[1] + 4];
                const iconInnerSize = isMain ? 20 : 16;
                const topPadding = (iconSize[1] - iconInnerSize) / 2 - (isMain ? 2 : 2);

                const html = `
                    <div style="position: relative; width: ${iconSize[0]}px; height: ${iconSize[1]}px; display: flex; justify-content: center; align-items: flex-start; padding-top: ${topPadding}px;">
                        <svg viewBox="0 0 24 24" width="${iconSize[0]}" height="${iconSize[1]}" style="position: absolute; left: 0; top: 0; filter: drop-shadow(0 2px 2px rgba(0,0,0,0.5));">
                            <path fill="${config.pinColor}" d="M12,2C8.1,2,5,5.1,5,9c0,5.2,7,13,7,13s7-7.8,7-13C19,5.1,15.9,2,12,2z"></path>
                        </svg>
                        <svg viewBox="0 0 24 24" width="${iconInnerSize}" height="${iconInnerSize}" style="position: relative; fill: ${config.iconColor};">
                            ${config.svg}
                        </svg>
                    </div>`;

                return L.divIcon({
                    html: html,
                    className: '',
                    iconSize: iconSize,
                    iconAnchor: iconAnchor,
                    popupAnchor: popupAnchor
                });
            }

            const mainVillageName = "Umera";
            const villageLat = 36.604836;
            const villageLng = 36.625117;
            const initialZoom = 14;

            const map = L.map('map').setView([villageLat, villageLng], initialZoom);

            // --- Define all the map layers ---
            const esriImagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                attribution: 'Tiles &copy; Esri'
            });

            const osmStreet = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            });

            const thunderforestTerrain = L.tileLayer('https://{s}.tile.thunderforest.com/outdoors/{z}/{x}/{y}{r}.png?apikey={apikey}', {
                attribution: '&copy; <a href="http://www.thunderforest.com/">Thunderforest</a>, &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
                apikey: 'e030b1cd0c1041a69a5ca2b0ca2ebe36', 
                maxZoom: 22
            });

            // --- Set up the layer control ---
            const baseMaps = {
                "Satellite": esriImagery,
                "Street": osmStreet,
                "Terrain": thunderforestTerrain
            };
            
            L.control.layers(baseMaps).addTo(map);
            esriImagery.addTo(map);

            // --- ADD MAP CONTROLS ---
            // 1. Static Scale Bar
            L.control.scale({ imperial: false }).addTo(map);

            // --- Fetch data and add markers ---
            fetch('afrin_locations.json')
                .then(response => {
                    if (!response.ok) throw new Error('Network response was not ok');
                    return response.json();
                })
                .then(locations => {
                    locations.forEach(location => {
                        const isMainVillage = location.name === mainVillageName;
                        const customIcon = createCustomIcon(location.type, isMainVillage);
                        
                        const marker = L.marker([location.lat, location.lng], { 
                            icon: customIcon,
                            zIndexOffset: isMainVillage ? 1000 : 0
                        }).addTo(map);
                        
                        marker.bindPopup(`<b>${location.name}</b><br><span>${location.type.replace(/_/g, ' ')}</span>`);

                        if (isMainVillage) {
                            marker.openPopup();
                        }
                    });
                })
                .catch(error => {
                    console.error('Error loading location data:', error);
                    const mapDiv = document.getElementById('map');
                    mapDiv.innerHTML = '<div style="text-align:center; padding: 20px; color: var(--subtext-color);">Could not load map data.<br>Please ensure <strong>afrin_locations.json</strong> is in the same folder as this HTML file.</div>';
                });
        });
    </script>
</body>
</html>
